define(["jquery","core/notification","core/str","core/templates","format_tiles/browser_storage"],function(a,b,c,d,e){"use strict";return{init:function(f,g,h,i,j,k){a(document).ready(function(){a("select#id_courseusesubtiles").change(function(b){"0"!==b.currentTarget.value&&a("input#id_courseusebarforheadings").prop("checked",!1)}),a("select#id_courseshowtileprogress").change(function(d){if("0"!==d.currentTarget.value){var e=a("select#id_enablecompletion");"0"===e.val()&&(e.val("1"),c.get_strings([{key:"completion",component:"completion"},{key:"completionswitchhelp",component:"format_tiles"}]).done(function(a){b.alert(a[0],a[1])}))}}),a("select#id_enablecompletion").change(function(b){"0"===b.currentTarget.value&&a("select#id_courseshowtileprogress").val("0")});var l=a("select#id_basecolour");d.render("format_tiles/colour_picker",{colours:l.find("option").map(function(b,c){var d=a(c),e=d.attr("value");return{colour:e,colourname:d.text(),selected:e===l.val(),id:e.replace("#","")}}).toArray()}).done(function(b){a(b).insertAfter(l),l.hide();var c=a(".colourpickercircle");c.click(function(b){var d=a(b.currentTarget);c.removeClass("selected"),d.addClass("selected"),l.val(d.attr("data-colour")),a("#colourselectnotify").fadeIn(200).fadeOut(1200)}),l.change(function(){c.removeClass("selected"),a("#colourpick_"+l.val().replace("#","")).addClass("selected")})});var m,n;if("course-edit"===f?(n=a("#id_defaulttileicon"),m=a("#id_defaulttileicon option:selected").text()):"course-editsection"===f&&(n=a("#id_tileicon"),m=a("#id_tileicon option:selected").text()),"course-edit"===f||"course-editsection"===f&&"0"!==j){var o;switch(n.val()){case"":o=g;break;default:o=n.val()}d.render("format_tiles/icon_picker_launch_btn",{initialicon:o,initialname:m,sectionId:i}).done(function(b){a(b).insertAfter(n),n.hide(),require(["format_tiles/icon_picker"],function(a){a.init(h,f)})})}else"course-editsection"===f&&"0"===j&&n.closest(".row").hide();e.init(h,1,1,1,0,0,k),e.cleanUpStorage()})}}});