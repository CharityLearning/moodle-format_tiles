{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}

{{!
    @template format_tiles/course_module

    Tiles loading icon template.

    The purpose of this template is to render a loading animation
    to be displayed on a tile while content is fetched from server.

    Classes required for JS:
    * none

    Data attributes required for JS:
    * none

    Context variables required for this template:
    *

    Example context (json):
    {
        cmid: 123456,
        modname: "label",
        modnameDisplay: "[Not applicable in this example but might say 'Word Document' for resource/file module]",
        modtitle: "[Not applicable in this example but respresents the title from the module table]",
        modtitle_inplaceeditable: "[Not applicable in this example but respresents the in place editable module title]",
        modResourceType: "",
        is_label: 1,
        hasSpacersBefore: 0,
        previouswaslabel: 0,
        useSubtiles: 1,
        isEmbeddedResource: 0,
        clickable: 1,
        extraclasses: "",
        isediting: 1,
        content: "This is a label",
        modinstance: "[Not applicable in this example but respresents the ID from the module table]",
        url: "[Not applicable in this example but respresents the URL for the link to launch the module]",
        description: "[Not applicable in this example but respresents the Description entered on the course module edit page]",
        cmeditmenu: "[HTML for course module edit menu]",
        cmmove: [move icon],
        availabilityinfo:
        completionInUseForCm: 1,
        completionIsManual: 1,
        completionstring: "Click to toggle completion status",
        completionstate: "1",
        completionstateInverse: "0",
    }
}}

{{! if this is a label (except first one in section) we need spacer activities before it so that the previous row of subtiles has correct flexbox width }}
{{#hasSpacersBefore}}
    {{^isediting}}
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
        <li class="subtile spacer" aria-hidden="true"></li>
    {{/isediting}}
{{/hasSpacersBefore}}
<li class="activity{{#useSubtiles}}{{^is_label}} subtile{{/is_label}}{{/useSubtiles}} {{modname}} modtype_{{modname}} {{modResourceType}}{{^clickable}} unclickable {{/clickable}}{{extraclasses}}" id="module-{{cmid}}" data-modtype="{{modname}}{{#modResourceType}}_{{{modResourceType}}}{{/modResourceType}}"
    tabindex="3"
    data-cmid="{{cmid}}"
    data-modinstance="{{modinstance}}"{{#pluginfileUrl}}
    data-url="{{{pluginfileUrl}}}"{{/pluginfileUrl}}
    data-title="{{{modtitle}}}">
    <div class="subtile_inner">
        <div class="{{#useSubtiles}}{{^is_label}}subtile-{{/is_label}}{{/useSubtiles}}activityinstance">
            {{#is_label}}
                {{#clickable}}
                    {{! clickable really means user is allowed to see content - }}
                    <span class="label_content" id="label_content_{{cmid}}">{{{content}}}</span>
                {{/clickable}}
            {{/is_label}}

            {{^is_label}}
                {{#useSubtiles}}
                    <div class="activitytype">{{modnameDisplay}}</div>
                    {{^isediting}}
                        <div class="instancename"{{#clickable}} data-action="launch-tiles-{{launchtype}}"{{/clickable}}>
                                {{#clickable}}
                                    {{#isEmbeddedResource}}
                                        <h4 class="activitytitle">
                                            <a href="{{{config.wwwroot}}}/mod/resource/view.php?id={{{cmid}}}" data-title="{{{modtitle}}}">{{{modtitle}}}</a>
                                        </h4>
                                    {{/isEmbeddedResource}}

                                    {{^isEmbeddedResource}}
                                    <h4 class="activitytitle">
                                        <a class="{{extraclasses}}" onclick="{{onclick}}" href="{{url}}">{{{modtitle}}}</a>
                                    </h4>
                                    {{/isEmbeddedResource}}
                                {{/clickable}}
                                {{^clickable}}
                                    <h4 class="activitytitle">{{{modtitle}}}</h4>
                                {{/clickable}}
                        </div>
                    {{/isediting}}

                    {{#isediting}}
                        <div class="activityinstance">
                            {{#modtitle_inplaceeditable}}
                                {{>core/inplace_editable}}
                            {{/modtitle_inplaceeditable}}
                            {{^modtitle_inplaceeditable}}
                                {{{modtitle}}}
                            {{/modtitle_inplaceeditable}}
                            <a class="clickable-region" href="{{url}}"></a>
                        </div>
                    {{/isediting}}
                {{/useSubtiles}}

                {{^useSubtiles}}
                    {{#clickable}}
                        <a href="{{url}}"{{#clickable}} {{#clickable}}{{#isEmbeddedResource}} data-action="launch-tiles-resource-modal"{{/isEmbeddedResource}}{{#isEmbeddedModule}} data-action="launch-tiles-activity-modal"{{/isEmbeddedModule}}{{/clickable}}{{/clickable}} data-title="{{{modtitle}}}">
                            <img src="{{iconurl}}" class="iconlarge activityicon" alt="{{{modtitle}}}"
                                 role="presentation">
                            <span class="instancename">{{{modtitle}}}</span>
                        </a>
                    {{/clickable}}

                    {{^clickable}}
                        <span class="editingactivity">
                            <img src="{{iconurl}}" class="iconlarge activityicon" alt="{{{modtitle}}}"
                                 role="presentation">
                            <span class="instancename">{{{modtitle}}}</span>
                        </span>
                    {{/clickable}}
                {{/useSubtiles}}

                {{^useSubtiles}}
                    <div class="contentafterlink">
                        {{{description}}}
                        {{{availabilityinfo}}}
                    </div>
                {{/useSubtiles}}
                {{#cmavailabilityinfo}}
                    {{>format_tiles/availability_info}}
                {{/cmavailabilityinfo}}
            {{/is_label}}

            {{#isediting}}
                <span class="subtilecontrols">
                    {{{cmmove}}}
                </span>
            {{/isediting}}
        </div>

        {{#isediting}}
            <span class="actions editactions">{{{cmeditmenu}}}</span>
        {{/isediting}}
    </div>

    <span class="actions">
        {{#completionInUseForCm}}
        {{! completion is enabled for this course module}}
        {{! we only want to display a completion icon if we are using subtiles but this item is not a label,}}
        {{! or we are not using sub tiles.  This is because in subtiles format, labels are only}}
        {{! used to divide activity sub tiles }}
            {{#useSubtiles}}
                {{^is_label}}
                    {{#completionenabled}}
                        {{>format_tiles/completion_icon}}
                    {{/completionenabled}}
                {{/is_label}}
            {{/useSubtiles}}
            {{^useSubtiles}}
                {{#completionenabled}}
                    {{>format_tiles/completion_icon}}
                {{/completionenabled}}
            {{/useSubtiles}}
        {{/completionInUseForCm}}
    </span>
</li>
